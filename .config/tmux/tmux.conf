TMUX_PLUGIN_MANAGER_PATH="~/.local/share/tmux/plugins"

if "test ! -d $TMUX_PLUGIN_MANAGER_PATH/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm $TMUX_PLUGIN_MANAGER_PATH/tpm && $TMUX_PLUGIN_MANAGER_PATH/tpm/bin/install_plugins'"

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

## Settings
set-option -g history-limit 100000
set -g mouse on
set -g prefix `
bind ` send-prefix
set -g prefix2 C-b
set-window-option -g mode-keys vi
unbind r
bind -N "Source tmux.conf" r source-file ~/.config/tmux/tmux.conf \; display-message "source-file done"

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# undercurl
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm' # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m' # underscore colours - needs tmux-3.0

# Splits
unbind %
unbind '"'
bind -N "Horizontal Split" | split-window -h -c "#{pane_current_path}" -l 30%
bind -N "Vertical Split" - split-window -v -c "#{pane_current_path}" -l 30%

# Split Navigations:
bind -N "Select the pane above the active pane" -r k select-pane -U
bind -N "Select the pane below the active pane" -r j select-pane -D
bind -N "Select the pane to the left of the active pane" -r h select-pane -L
bind -N "Select the pane to the right of the active pane" -r l select-pane -R

# Split Resize:
bind -N "Resize the pane up by 5" -r K resize-pane -U 5
bind -N "Resize the pane down by 5" -r J resize-pane -D 5
bind -N "Resize the pane left by 5" -r H resize-pane -L 5
bind -N "Resize the pane right by 5" -r L resize-pane -R 5

# Windows
bind -N "Create a new window" -r c new-window -c "#{pane_current_path}"
bind -N "Select the previously current window" -r b last-window
bind -N "Select the next pane" -r n next-window
bind -N "Select the previous window" -r p previous-window

# Panes
bind -N "Select the next pane" -r o select-pane -t :.+
bind -N "Move to last and maximize pane" -r m last-pane -Z 

# Sessions
bind -N "Kill session" C-k confirm-before kill-session

# Status
bind -N "Toggle status" -r '\' set -g status
set-option -g status-position top
set-option -g status-interval 5
set-option -g status-keys vi
set-option -g status off

set -g pane-border-indicators arrows
set -g pane-border-style fg=blue

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b "$TMUX_PLUGIN_MANAGER_PATH/tpm/tpm"
